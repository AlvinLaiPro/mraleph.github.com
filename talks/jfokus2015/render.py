#!/usr/bin/env python

#
# Generate png slides from HTML slides.
#

import time
from selenium import webdriver

browser = webdriver.Chrome()
browser.get('http://localhost:8000/talks/jfokus2015/')
time.sleep(5)

# Coordinates obtained via Klass.dumpCoordinates after
# manually arranging objects on the slides.
browser.execute_script('''
  Klass.setCoordinates([{"x":0,"y":0},{"x":50,"y":0},{"x":-67.01847076416016,"y":32.63852310180664},{"x":-6.200527906417847,"y":42.902374267578125},{"x":46.69953094393793,"y":41.66477658204043},{"x":129.29142153487754,"y":57.814449824331916},{"x":128.9889369461781,"y":77.46619551829633},{"x":79.44357725728844,"y":53.52121051053271},{"x":132.10885747959134,"y":14.470964421007722},{"x":133.1050998132444,"y":56.285737274589536},{"x":133.26824595378537,"y":99.43133256224532},{"x":133.32991543272817,"y":137.53199593072807},{"x":64.97857818513774,"y":15.315054788353194},{"x":-44.18478393132854,"y":14.65944823943994},{"x":12.52651885574852,"y":30.233658037739467},{"x":127.30844673956364,"y":37.996534356607754},{"x":97.99455831849103,"y":33.06040460467783},{"x":22.476122307536613,"y":40.14824107143522},{"x":114.20432965109933,"y":66.2111218939521},{"x":156.04449181205916,"y":61.45974851849742},{"x":133.47377159670884,"y":54.95551380678643},{"x":134.18989028628266,"y":73.14622371964997},{"x":118.40502597378914,"y":113.85536037400692},{"x":79.91095708662823,"y":104.83933104920521},{"x":94.5613475550501,"y":133.85469876568078},{"x":30.786718914080467,"y":61.1498623355794},{"x":72.17665035394853,"y":74.41331738572865},{"x":113.2575367038325,"y":86.54807195129534},{"x":90,"y":40},{"x":130,"y":40},{"x":170,"y":40},{"x":90,"y":40},{"x":130,"y":40},{"x":170,"y":40},{"x":90,"y":40},{"x":130,"y":40},{"x":170,"y":40}]);
''')

slide = 0
while True:
  time.sleep(3)
  browser.save_screenshot('slides/slide-%d.png' % (slide))
  if browser.execute_script("return Reveal.isLastSlide()"):
    break
  slide = slide + 1
  browser.execute_script("Reveal.next()")

browser.quit()